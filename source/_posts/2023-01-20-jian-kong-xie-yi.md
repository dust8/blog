---
title: 监控协议笔记
date: 2023-01-20 06:15:31
tags:
  - 协议
---

摄像头通过RS485控制云台的转动.

## IP监控系统协议组件
- 控制流, 通过SIP业务控制,RTSP URL查询/返回结果
- 实时流, 实时视频
- 存储流和回放流, TRP/TS回放流, iSCSI检索/回放

### 管理控制协议-SIP
SIP(Session Initiation Protocol, 会话初始协议) 是应用层的会话控制协议, 用于创建,修改和释放一个或多个参与者参加的会话.
SIP协议采用基于文本格式的客户/服务器模式.
SIP的基本功能包含:
- 用户定位
- 用户能力协商
- 用户可用性确定
- 会话建立
- 会话管理

SDP是会话描述协议, 用于为SIP, RTSP, HTTP等协议描述会话信息.

SIP消息分为Request消息和Response消息两类.
Request消息通过Request-Line中的Method来区分消息的类别
Response消息通过Status-Line中的Status Code来区分消息类别

常见的SIP请求消息如下:
- INVITE: 表示主叫用户发起会话请求, 邀请其他用户加入一个会话. 也可以用在呼叫建立后用户更新会话
- ACK: 客户端向服务器证实它已经收到了对INVITE请求的最终响应
- BYE: 表示终止一个已经建立的呼叫
- CANCEL: 表示在收到对请求的最终响应之前取消该请求, 对于已经完成的请求则无影响
- REGISTER:表示客户端向SIP服务器端注册列在To字段中的地址信息
- OPTIONS: 表示查询被叫的相关信息和功能

常见的SIP响应消息如下:
- 100试呼叫(Trying)
- 200成功响应(OK)
- 400错误请求(Bad Request)
- 401未授权(Unauthorized)
- 403禁止(Forbidden)
- 404用户不存在(Not Found)
- 408请求超时(Request Timeout)

## 管理控制协议-SNMP
SNMP(Simple Network Management Protocol, 简单网络管理协议) 是对网络进行管理的一个框架, 它提供一组基本的操作来监视和维护网络.
SNMP可以实现自动化管理并可以屏蔽不同设备的物理差异, 实现对不同厂商产品的自动化管理.
SNMP网络元素分为NMS和Agent两种.
- NMS(Network Management Station, 网络管理站)
- Agent是驻留在设备上的一个进程, 负责接收处理来自NMS的请求报文


## 传输协议-TS&PS
- TS流(Transport Stream): 传输流, 将具有共同时间基准或独立时间基准的一个或多个PES组合而成的单一数据流(用于数据传输)
- PS流(Program Stream): 节目流, 将具有共同时间基准的一个或多个PES组合而成的单一数据流(用于播放和编辑系统, 如m2p)

TS流和PS流的区别:
TS流的包结构是长度固定的, PS流的包结构是可变长度的.这导致了TS流的抵抗传输误码的能力强于PS流.

## 传输协议-RTP
RTP(Real-time Transport Protocol): 实时传输协议, 详细说明了在互联网上传递音频和视频的标准数据包格式, 是一个传输层的基于UDP的协议.
RTP协议提供的信息包括: 时间戳(用于同步), 序列号(用于丢包和重排序检测), 以及负载格式(用于说明数据的编码格式).
RTP协议被用来为音视频等实时数据提供端到端的网络传输, 传输的模型可以是单点传送和多点传送.
RTP协议是为支持实时业务而设计的, 保证业务的接收和发送在很短时间内完成.

## 存储回放协议-iSCSI
iSCSI(Internet Small Computer System Interface): Internet 小型计算机系统接口, 是一种基于TCP/IP的协议, 用来建立和管理IP存储设备, 主机和客户机之间的相互连接, 并创建存储区域网络(SAN)

## 存储回放协议-RTSP
RTSP(RealTime Streaming Protocol)实时流传输协议, 是TCP/IP协议体系中的一个应用层协议.该协议定义了一对多应用程序如何有效的通过IP网络传送多媒体数据. RTSP在体系结构上位于RTP/RTCP之上, 它使用TCP/UDP完成数据传输.


## 互联协议-ONVIF
ONVIF(Open Network Video Interface Forum), 开放型网络视频接口论坛, 描述了网络视频的模型,接口,数据类型以及数据交互模式, 目标是实现一个网络视频框架协议, 使不同厂商所生产的网络视频产品完全互通.
ONVIF规范的基本功能定义有:
- 设备发现
- 设备管理
- 实时流媒体
- 事件处理
- PTZ控制
- 其他

## 互联协议-国标GB28181
是国内定的标准, 类似ONVIF. 主要针对视频监控.
国标主要业务包含:
- 域间注册
- 域间保活
- 云台控制
- 实况业务
- 录像检索和回放


## 前端智能应用
- 人脸抓拍, 检测并抓拍人脸图片
- 人数统计, 客流统计, 人数统计, 人流量统计等均为人数统计功能, 统计视频中出现的人数
- 周界防范, 穿越警戒线, 区域入侵, 进入/离开区域等
- 跟踪球, 对运动目标自动统计
- 违停球, 对违停车辆进行自动抓拍, 生成证据链上传中心